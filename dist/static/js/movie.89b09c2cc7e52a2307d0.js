webpackJsonp([1],[,,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={mounted:function(){var t=this;this.$http.get("/get_login_state").then(function(e){e.body.user&&(t.user=e.body.user,t.$emit("isLogin",t.user))}).catch(function(t){console.log("failed to connect")})},data:function(){return{msg:"",login:!1,user:0}},methods:{action_data:function(){this.msg&&alert(this.msg)},submitLogin:function(t){t.preventDefault(),this.$http.post(t.target.action,{username:this.$refs.username.value,password:this.$refs.password.value}).then(function(t){switch(t.body.code){case 3e3:window.location.reload();break;case 3001:alert("用户名或密码错误，请重试");break;case 3002:alert("用户名或密码格式不正确，请重试");break;case 3003:alert("服务忙，请重试")}})}}}},function(t,e){},function(t,e){},function(t,e,a){t.exports=a.p+"static/img/logo.2965242.png"},function(t,e,a){function n(t){a(5)}var s=a(0)(a(3),a(10),n,null,null);t.exports=s.exports},function(t,e,a){function n(t){a(6)}var s=a(0)(a(4),a(11),n,null,null);t.exports=s.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer"},[a("div",{staticClass:"footer_inner"},[a("table",{staticClass:"footer_tb"},[a("tr",[a("td",[a("a",{attrs:{href:"#"}},[t._v("中国互联网举报中心")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("xICP备xxxx号")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("节目制作经营许可证x字第xxx号")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("xICP证xxxxx号")])])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#"}},[t._v("网络文化经营单位")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("xx互联网举报中心")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("网络110报警服务")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("x网文xxxxxxx号")])])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"#"}},[t._v("x公安备xxxxxxxx号")])]),t._v(" "),a("td",[a("a",{attrs:{href:"#"}},[t._v("12318文化市场举报热线")])])])]),t._v(" "),a("div",{staticClass:"footer_bottom"},[a("h1",[t._v("xx电影网")]),t._v(" "),a("p",[t._v("本站不提供任何视听上传服务，所有内容均来自视频分享站点所提供的公开引用资源。Copyright © 200x-2017 保留所有权利")])])])])}]}},function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header-wrapper"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.user,expression:"user==0"}],staticClass:"login_reg"},[a("span",{on:{mouseover:function(e){t.login=!0},mouseout:function(e){t.login=!1}}},[a("a",[t._v("登录")]),t._v(" "),a("transition",{attrs:{name:"login_fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.login,expression:"login"}],staticClass:"login_wrapper"},[a("form",{staticClass:"login",attrs:{method:"post",action:"/login"},on:{submit:t.submitLogin}},[a("input",{ref:"username",attrs:{type:"text",name:"username",placeholder:"请输入用户名"}}),a("br"),t._v(" "),a("input",{ref:"password",attrs:{type:"password",name:"password",placeholder:"请输入密码"}}),t._v(" "),a("button",{attrs:{type:"submit"}},[t._v("登录")])])])])],1),t._v("|\n    "),a("a",{attrs:{href:"./register"}},[t._v("注册")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.user,expression:"user!=0"}],staticClass:"userLogin"},[a("span",[t._v("欢迎您！用户："+t._s(t.user.username))]),t._v(" "),a("span",[a("a",{attrs:{href:"/logout"},on:{click:function(e){t.user=0}}},[t._v(" 退出")])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"logo-wrapper"},[n("img",{attrs:{src:a(7),alt:"",width:"50px",height:"50px"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",[a("a",{attrs:{href:"/"}},[t._v("xx电影网")])])}]}},function(t,e){},,function(t,e,a){function n(t){a(24)}var s=a(0)(a(19),a(31),n,null,null);t.exports=s.exports},,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{count:Number,pageSize:Number,bar_number:Number},data:function(){return{pages:[],btnFlag:1,btn_on:"on",initFlag:!1}},mounted:function(){this.renderPageNum()},methods:{renderPageNum:function(){if(this.pages=[],this.count<=this.pageSize*this.bar_number)for(var t=Math.ceil(this.count/this.pageSize),e=1;e<=t;e++)this.pages.push(e);else for(var a=1;a<=this.bar_number;a++)this.pages.push(a);this.$nextTick()},handlePage:function(t){if("SPAN"==t.target.tagName){var e=t.target.getAttribute("pageData");switch(e){case"first":this.handleBtnFlag("first");break;case"lastPage":this.handleBtnFlag("last");break;case"nextPage":this.handleBtnFlag("next");break;case"end":this.handleBtnFlag("end");break;default:if(this.btnFlag==parseInt(e))return;this.btnFlag=parseInt(e),this.$emit("pageChange",this.btnFlag)}}},handleBtnFlag:function(t){var e=Math.ceil(this.count/this.pageSize);if("last"==t){if(1==this.btnFlag)return;if(this.btnFlag--,this.$emit("pageChange",this.btnFlag),this.btnFlag%this.bar_number==0){this.pages=[];for(var a=this.btnFlag-this.bar_number,n=0;n<this.bar_number;n++)a++,this.pages.push(a)}}else if("next"==t){if(this.btnFlag==Math.ceil(this.count/this.pageSize))return;if(this.btnFlag++,this.$emit("pageChange",this.btnFlag),this.btnFlag%this.bar_number==1){this.pages=[];for(var s=this.btnFlag,i=0;i<this.bar_number;i++){if(s>e)return;this.pages.push(s),s++}}}else if("end"==t){if(this.btnFlag==e)return;this.btnFlag=e,this.$emit("pageChange",this.btnFlag);var r=this.btnFlag-this.bar_number+1;this.pages=[];for(var o=0;o<this.bar_number;o++)r>e||r<1?r++:(this.pages.push(r),r++)}else if("first"==t){if(1==this.btnFlag)return;this.btnFlag=1,this.$emit("pageChange",this.btnFlag),this.pages=[];for(var c=1;c<=this.bar_number;c++){if(c>e)return;this.pages.push(c)}}}}}},,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(9),s=a.n(n),i=a(8),r=a.n(i),o=a(29),c=a.n(o);e.default={data:function(){return{movieData:"",comments:[],inputComment:"",user:"",locked:!0,pageSize:5,count:!1,bar_number:5}},mounted:function(){var t=this,e=parseInt(/[0-9]+$/.exec(window.location.href));this.$http.get("/movie_data",{params:{mid:e}}).then(function(e){t.movieData=e.body,document.title=e.body.title}).catch(function(t){console.log("failed to connect")}),this.$http.get("/comment",{params:{mid:e,page:1,pageSize:this.pageSize,count:!0}}).then(function(e){t.comments=e.body.comments,t.count=e.body.count}).catch(function(t){console.log(t)})},methods:{sendData:function(t){var e=this;t.preventDefault();var a=this.inputComment.trim(),n=new Date,s=this.user.id,i=parseInt(/[0-9]+$/.exec(window.location.href));if(a.length>200)return void alert("字数超过了"+(a.length-200)+"字");a&&this.$http.post("/comment",{content:a,time:n.toLocaleString(),uid:s,mid:i}).then(function(t){5e3==t.body.code?(alert("评论成功"),e.count++,e.$nextTick(function(){this.$refs.pagesBar.renderPageNum()}),e.comments.length>=5&&e.comments.pop(),e.comments.unshift({content:a,time:n.toLocaleString(),username:e.user.username}),0==e.count&&(e.count=1)):alert("服务器忙，请重试")})},loginState:function(t){t&&(this.locked=!1,this.user=t)},getComments:function(t){var e=this,a=parseInt(/[0-9]+$/.exec(window.location.href));this.$http.get("comment",{params:{mid:a,page:t,pageSize:this.pageSize}}).then(function(t){e.comments=t.body.comments}).catch(function(t){throw Error(t)})}},components:{myHeader:s.a,myFooter:r.a,pagesBar:c.a}}},,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(2),s=a(14),i=a.n(s),r=a(1);n.a.use(r.a);new n.a({render:function(t){return t(i.a)}}).$mount("#movie")},,function(t,e){},function(t,e){},,,,function(t,e,a){function n(t){a(25)}var s=a(0)(a(16),a(32),n,null,null);t.exports=s.exports},,function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("myHeader",{on:{isLogin:t.loginState}}),t._v(" "),a("div",{staticClass:"movie_wrapper"},[a("div",{staticClass:"info_wrapper"},[a("img",{attrs:{src:t.movieData.img,width:"300px",height:"400px",alt:""}}),t._v(" "),a("ul",[a("li",[a("span",[t._v("片名：")]),t._v(t._s(t.movieData.title))]),t._v(" "),a("li",[a("span",[t._v("导演：")]),t._v(t._s(t.movieData.director))]),t._v(" "),a("li",[a("span",[t._v("主演：")]),t._v(t._s(t.movieData.actors))]),t._v(" "),a("li",[a("span",[t._v("年份：")]),t._v(t._s(t.movieData.year))]),t._v(" "),a("li",[a("span",[t._v("评分：")]),t._v(t._s(t.movieData.rating))])])]),t._v(" "),a("div",{staticClass:"comment_wrapper"},[a("h3",[t._v("评论")]),t._v(" "),a("ul",t._l(t.comments,function(e){return a("li",{staticClass:"comment_item"},[a("span",{staticClass:"user"},[t._v(t._s(e.username)+":")]),t._v(" "),a("p",{staticClass:"comment"},[t._v(t._s(e.content))]),t._v(" "),a("span",{staticClass:"date"},[t._v(t._s(e.time))])])})),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.count,expression:"count==0"}],staticClass:"no_comment"},[t._v("\n        暂无评论\n      ")])]),t._v(" "),t.count?a("pagesBar",{ref:"pagesBar",attrs:{count:t.count,pageSize:t.pageSize,bar_number:t.bar_number},on:{pageChange:t.getComments}}):t._e(),t._v(" "),a("div",{staticClass:"input_wrapper"},[a("form",{staticClass:"input",attrs:{action:"/comment",method:"post"},on:{submit:t.sendData}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputComment,expression:"inputComment"}],staticClass:"content",attrs:{name:"content",disabled:t.locked,spellcheck:"false"},domProps:{value:t.inputComment},on:{input:function(e){e.target.composing||(t.inputComment=e.target.value)}}}),t._v(" "),a("input",{staticClass:"submit_btn",attrs:{type:"submit",value:"提交"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.locked,expression:"locked"}],staticClass:"lockedInfo"},[t._v("\n        登录后评论\n      ")]),t._v(" "),a("span",{staticClass:"word_limit"},[t._v("最多200字")])])],1),t._v(" "),a("myFooter")],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bar_wrapper",on:{click:t.handlePage}},[a("span",{staticClass:"large_btn",attrs:{pageData:"first"}},[t._v("首页")]),t._v(" "),a("span",{staticClass:"large_btn",attrs:{pageData:"lastPage"}},[t._v("上一页")]),t._v(" "),t._l(t.pages,function(e,n){return a("span",{class:t.btnFlag==e?t.btn_on:"",attrs:{pageData:e}},[t._v(t._s(e))])}),t._v(" "),a("span",{staticClass:"large_btn",attrs:{pageData:"nextPage"}},[t._v("下一页")]),t._v(" "),a("span",{staticClass:"large_btn",attrs:{pageData:"end"}},[t._v("最后")])],2)},staticRenderFns:[]}}],[22]);